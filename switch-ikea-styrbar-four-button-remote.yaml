blueprint:
  name: Switch - IKEA STYRBAR - four button remote
  description: 'Control your home with an IKEA STYRBAR remote,
    for use with [ZHA](https://www.home-assistant.io/integrations/zha/).

    Version: 1.0.0

    Compatible with:
    - IKEA STYRBAR remote (E2001/E2002)
    - IKEA STYRBAR Remote control N2


    All four buttons can be configured with both short press and long press actions.


    Each button can be configured independently:
    - Up button: Short press and long press
    - Down button: Short press and long press
    - Left button: Short press and long press
    - Right button: Short press and long press


    Note: For the left and right buttons, before the long press event is sent, 
    the "on" event gets triggered first.'
  domain: automation
  input:
    remote:
      name: Remote
      description: IKEA STYRBAR remote to use
      selector:
        device:
          integration: "zha"
          manufacturer: "IKEA of Sweden"
          model: "Remote Control N2"
          multiple: false
    button_up_short:
      name: Up button - short press
      description: Action to run on short press of up button
      default: []
      selector:
        action: {}
    button_up_long:
      name: Up button - long press
      description: Action to run on long press of up button
      default: []
      selector:
        action: {}
    button_down_short:
      name: Down button - short press
      description: Action to run on short press of down button
      default: []
      selector:
        action: {}
    button_down_long:
      name: Down button - long press
      description: Action to run on long press of down button
      default: []
      selector:
        action: {}
    button_left_short:
      name: Left button - short press
      description: Action to run on short press of left button
      default: []
      selector:
        action: {}
    button_left_long:
      name: Left button - long press
      description: Action to run on long press of left button. Use with care, as before
        the long press event is sent, the "on" event gets triggered.
      default: []
      selector:
        action: {}
    button_right_short:
      name: Right button - short press
      description: Action to run on short press of right button
      default: []
      selector:
        action: {}
    button_right_long:
      name: Right button - long press
      description: Action to run on long press of right button. Use with care, as before
        the long press event is sent, the "on" event gets triggered.
      default: []
      selector:
        action: {}
  source_url: https://github.com/Baanaaana/ha-blueprint/tree/main
mode: restart
max_exceeded: silent
trigger:
  - platform: event
    event_type: zha_event
    event_data:
      device_id: !input remote
action:
  - variables:
      command: "{{ trigger.event.data.command }}"
      cluster_id: "{{ trigger.event.data.cluster_id }}"
      endpoint_id: "{{ trigger.event.data.endpoint_id }}"
      args: "{{ trigger.event.data.args }}"
  - choose:
      - conditions:
          - "{{ command == 'on' }}"
          - "{{ cluster_id == 6 }}"
          - "{{ endpoint_id == 1 }}"
        sequence: !input button_up_short
      - conditions:
          - "{{ command == 'move_with_on_off' }}"
          - "{{ cluster_id == 8 }}"
          - "{{ endpoint_id == 1 }}"
        sequence: !input button_up_long
      - conditions:
          - "{{ command == 'off' }}"
          - "{{ cluster_id == 6 }}"
          - "{{ endpoint_id == 1 }}"
        sequence: !input button_down_short
      - conditions:
          - "{{ command == 'move' }}"
          - "{{ cluster_id == 8 }}"
          - "{{ endpoint_id == 1 }}"
        sequence: !input button_down_long
      - conditions:
          - "{{ command == 'press' }}"
          - "{{ cluster_id == 5 }}"
          - "{{ endpoint_id == 1 }}"
          - "{{ args == [257, 13, 0] }}"
        sequence: !input button_left_short
      - conditions:
          - "{{ command == 'hold' }}"
          - "{{ cluster_id == 5 }}"
          - "{{ endpoint_id == 1 }}"
          - "{{ args == [3329, 0] }}"
        sequence: !input button_left_long
      - conditions:
          - "{{ command == 'press' }}"
          - "{{ cluster_id == 5 }}"
          - "{{ endpoint_id == 1 }}"
          - "{{ args == [256, 13, 0] }}"
        sequence: !input button_right_short
      - conditions:
          - "{{ command == 'hold' }}"
          - "{{ cluster_id == 5 }}"
          - "{{ endpoint_id == 1 }}"
          - "{{ args == [3328, 0] }}"
        sequence: !input button_right_long
